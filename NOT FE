-- Serviços
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer

-- GUI
local gui = Instance.new("ScreenGui", LocalPlayer:WaitForChild("PlayerGui"))
gui.Name = "TPGui"
gui.ResetOnSpawn = false

-- Menu
local frame = Instance.new("Frame")
frame.Size = UDim2.new(0, 250, 0, 260)
frame.Position = UDim2.new(0.5, -125, 0.5, -130)
frame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
frame.Active = true
frame.Draggable = true
frame.Parent = gui

local corner = Instance.new("UICorner", frame)
corner.CornerRadius = UDim.new(0, 12)

-- Scrolling Lista
local scroll = Instance.new("ScrollingFrame", frame)
scroll.Size = UDim2.new(0.9, 0, 0.65, 0)
scroll.Position = UDim2.new(0.05, 0, 0.05, 0)
scroll.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
scroll.BorderSizePixel = 0
scroll.ScrollBarThickness = 4
scroll.CanvasSize = UDim2.new(0, 0, 0, 0)

local scrollCorner = Instance.new("UICorner", scroll)
scrollCorner.CornerRadius = UDim.new(0, 8)

local layout = Instance.new("UIListLayout", scroll)
layout.Padding = UDim.new(0, 5)

-- Botão TP
local tpBtn = Instance.new("TextButton", frame)
tpBtn.Size = UDim2.new(0.9, 0, 0, 35)
tpBtn.Position = UDim2.new(0.05, 0, 0.74, 0)
tpBtn.Text = "TP PLAYER"
tpBtn.BackgroundColor3 = Color3.fromRGB(0, 170, 255)
tpBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
tpBtn.TextScaled = true
tpBtn.BorderSizePixel = 0

local btnCorner = Instance.new("UICorner", tpBtn)
btnCorner.CornerRadius = UDim.new(0, 8)

-- Botão Fechar/Abrir
local toggle = Instance.new("TextButton", gui)
toggle.Size = UDim2.new(0, 120, 0, 30)
toggle.Position = UDim2.new(0, 20, 0, 20)
toggle.Text = "Fechar Menu"
toggle.BackgroundColor3 = Color3.fromRGB(255, 85, 85)
toggle.TextColor3 = Color3.fromRGB(255, 255, 255)
toggle.TextScaled = true
toggle.BorderSizePixel = 0

local toggleCorner = Instance.new("UICorner", toggle)
toggleCorner.CornerRadius = UDim.new(0, 8)

-- Variável jogador selecionado
local selectedPlayer = nil

-- Função para atualizar lista
local function atualizarLista()
	for _, child in ipairs(scroll:GetChildren()) do
		if child:IsA("TextButton") then
			child:Destroy()
		end
	end

	for _, p in ipairs(Players:GetPlayers()) do
		if p ~= LocalPlayer then
			local btn = Instance.new("TextButton")
			btn.Size = UDim2.new(1, 0, 0, 30)
			btn.Text = p.Name
			btn.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
			btn.TextColor3 = Color3.fromRGB(255, 255, 255)
			btn.TextScaled = true
			btn.BorderSizePixel = 0
			btn.Parent = scroll

			local bcorner = Instance.new("UICorner", btn)
			bcorner.CornerRadius = UDim.new(0, 6)

			btn.MouseButton1Click:Connect(function()
				selectedPlayer = p
				for _, other in ipairs(scroll:GetChildren()) do
					if other:IsA("TextButton") then
						other.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
					end
				end
				btn.BackgroundColor3 = Color3.fromRGB(0, 170, 255)
			end)
		end
	end

	wait()
	scroll.CanvasSize = UDim2.new(0, 0, 0, layout.AbsoluteContentSize.Y + 10)
end

-- Atualiza quando jogador entra ou sai
Players.PlayerAdded:Connect(atualizarLista)
Players.PlayerRemoving:Connect(atualizarLista)

-- Ação do botão de TP
tpBtn.MouseButton1Click:Connect(function()
	if selectedPlayer and selectedPlayer.Character and selectedPlayer.Character:FindFirstChild("HumanoidRootPart") then
		local myHRP = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
		if myHRP then
			myHRP.CFrame = selectedPlayer.Character.HumanoidRootPart.CFrame + Vector3.new(0, 3, 0)
		end
	end
end)

-- Mostrar/ocultar menu
local aberto = true
toggle.MouseButton1Click:Connect(function()
	aberto = not aberto
	frame.Visible = aberto
	toggle.Text = aberto and "Fechar Menu" or "Abrir Menu"
end)

-- Inicial
atualizarLista()
